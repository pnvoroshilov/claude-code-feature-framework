# Hooks Management - –ü–æ–ª–Ω–∞—è —Å–≤–æ–¥–∫–∞ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

## ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏

### 1. –ë–∞–∑–æ–≤–∞—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å
- ‚úÖ 5 –¥–µ—Ñ–æ–ª—Ç–Ω—ã—Ö —Ö—É–∫–æ–≤ –≤ `framework-assets/claude-hooks/`
- ‚úÖ –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö (3 —Ç–∞–±–ª–∏—Ü—ã: default_hooks, custom_hooks, project_hooks)
- ‚úÖ 8 API endpoints
- ‚úÖ Frontend UI —Å 4 –≤–∫–ª–∞–¥–∫–∞–º–∏
- ‚úÖ –ù–∞–≤–∏–≥–∞—Ü–∏—è (Sidebar + Routes)

### 2. –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª –≤–∫–ª—é—á–µ–Ω–∏—è/–æ—Ç–∫–ª—é—á–µ–Ω–∏—è
- ‚úÖ –í–∫–ª—é—á–∏—Ç—å —Ö—É–∫ ‚Üí –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è –≤ `.claude/settings.json`
- ‚úÖ –û—Ç–∫–ª—é—á–∏—Ç—å —Ö—É–∫ ‚Üí —É–¥–∞–ª—è–µ—Ç—Å—è –∏–∑ `.claude/settings.json`
- ‚úÖ –ò–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å: –ø–æ–≤—Ç–æ—Ä–Ω–æ–µ –≤–∫–ª—é—á–µ–Ω–∏–µ –Ω–µ –≤—ã–∑—ã–≤–∞–µ—Ç –æ—à–∏–±–∫—É

### 3. –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ö—É–∫–æ–≤ ‚≠ê –ü–û–õ–ù–û–°–¢–¨–Æ –†–ê–ë–û–¢–ê–ï–¢
- ‚úÖ –ö–Ω–æ–ø–∫–∞ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –Ω–∞ –≤—Å–µ—Ö –≤–∫–ª–∞–¥–∫–∞—Ö
- ‚úÖ –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ default hooks
- ‚úÖ –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ custom hooks
- ‚úÖ Edit dialog —Å –≤–∞–ª–∏–¥–∞—Ü–∏–µ–π JSON
- ‚úÖ **–ò–∑–º–µ–Ω–µ–Ω–∏—è –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è –∫ `.claude/settings.json`**
- ‚úÖ **–°–∏—Å—Ç–µ–º–∞ rebuild settings.json**

### 4. –°–æ–∑–¥–∞–Ω–∏–µ custom hooks
- ‚úÖ UI —Ñ–æ—Ä–º–∞ —Å–æ–∑–¥–∞–Ω–∏—è
- ‚úÖ Slash command `/create-hook`
- ‚úÖ Subagent `hook-creator`
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –∫ settings.json

### 5. Favorites
- ‚úÖ –î–æ–±–∞–≤–∏—Ç—å –≤ –∏–∑–±—Ä–∞–Ω–Ω–æ–µ
- ‚úÖ –£–±—Ä–∞—Ç—å –∏–∑ –∏–∑–±—Ä–∞–Ω–Ω–æ–≥–æ
- ‚úÖ –í–∫–ª–∞–¥–∫–∞ Favorites

## üîß –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

### –ü—Ä–æ–±–ª–µ–º–∞ 1: –¢–æ–ª—å–∫–æ 4 —Ö—É–∫–∞ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è
**–ü—Ä–∏—á–∏–Ω–∞:** –ö—ç—à –±—Ä–∞—É–∑–µ—Ä–∞  
**–†–µ—à–µ–Ω–∏–µ:** –û–±–Ω–æ–≤–∏—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É (–≤—Å–µ 5 —Ö—É–∫–æ–≤ –≤ –±–∞–∑–µ –∏ API)

### –ü—Ä–æ–±–ª–µ–º–∞ 2: –ù–µ—Ç —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –¥–µ—Ñ–æ–ª—Ç–Ω—ã—Ö —Ö—É–∫–æ–≤
**–†–µ—à–µ–Ω–∏–µ:** –î–æ–±–∞–≤–ª–µ–Ω–∞ –∫–Ω–æ–ø–∫–∞ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –Ω–∞ –≤—Å–µ –≤–∫–ª–∞–¥–∫–∏

### –ü—Ä–æ–±–ª–µ–º–∞ 3: –ò–∑–º–µ–Ω–µ–Ω–∏—è –Ω–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ settings.json ‚≠ê
**–ü—Ä–∏—á–∏–Ω–∞:** –ú–µ—Ç–æ–¥ `remove_hook_from_settings()` –Ω–µ –±—ã–ª —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω

**–†–µ—à–µ–Ω–∏–µ:** –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ —Å–∏—Å—Ç–µ–º–∞ **–ø–æ–ª–Ω–æ–π –ø–µ—Ä–µ—Å—Ç—Ä–æ–π–∫–∏ settings.json**

#### –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç rebuild:
```python
async def _rebuild_settings_json(project_id, project_path):
    # 1. –ü–æ–ª—É—á–∏—Ç—å –í–°–ï –≤–∫–ª—é—á–µ–Ω–Ω—ã–µ —Ö—É–∫–∏ –∏–∑ –±–∞–∑—ã
    enabled_hooks = SELECT * FROM project_hooks WHERE project_id = ...
    
    # 2. –î–ª—è –∫–∞–∂–¥–æ–≥–æ –ø–æ–ª—É—á–∏—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é
    merged_config = {}
    for hook in enabled_hooks:
        hook_data = get_hook_config(hook.hook_id, hook.hook_type)
        merge(merged_config, hook_data.hook_config)
    
    # 3. –ü–æ–ª–Ω–æ—Å—Ç—å—é –∑–∞–º–µ–Ω–∏—Ç—å settings.json
    settings["hooks"] = merged_config
    save(settings)
```

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- ‚úÖ settings.json –≤—Å–µ–≥–¥–∞ –æ—Ç—Ä–∞–∂–∞–µ—Ç –∞–∫—Ç—É–∞–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –±–∞–∑—ã
- ‚úÖ –ù–µ—Ç –æ—Å—Ç–∞—Ç–∫–æ–≤ —Å—Ç–∞—Ä—ã—Ö –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–π
- ‚úÖ –ü—Ä–æ—Å—Ç–æ –∏ –Ω–∞–¥–µ–∂–Ω–æ
- ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç –ø—Ä–∏ –ª—é–±–æ–º –∏–∑–º–µ–Ω–µ–Ω–∏–∏ —Ö—É–∫–∞

### –ü—Ä–æ–±–ª–µ–º–∞ 4: "Hook already enabled"
**–†–µ—à–µ–Ω–∏–µ:** –°–¥–µ–ª–∞–Ω –∏–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω—ã–º - –ø–æ–≤—Ç–æ—Ä–Ω–æ–µ –≤–∫–ª—é—á–µ–Ω–∏–µ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —É—Å–ø–µ—Ö

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–æ–≤

```
framework-assets/
‚îú‚îÄ‚îÄ claude-hooks/          # 5 –¥–µ—Ñ–æ–ª—Ç–Ω—ã—Ö —Ö—É–∫–æ–≤
‚îÇ   ‚îú‚îÄ‚îÄ bash-command-logger.json
‚îÇ   ‚îú‚îÄ‚îÄ code-formatter.json
‚îÇ   ‚îú‚îÄ‚îÄ desktop-notifications.json
‚îÇ   ‚îú‚îÄ‚îÄ file-protection.json
‚îÇ   ‚îî‚îÄ‚îÄ git-auto-commit.json
‚îú‚îÄ‚îÄ claude-commands/
‚îÇ   ‚îú‚îÄ‚îÄ create-hook.md
‚îÇ   ‚îî‚îÄ‚îÄ edit-hook.md
‚îî‚îÄ‚îÄ claude-agents/
    ‚îî‚îÄ‚îÄ hook-creator.md

claudetask/backend/
‚îú‚îÄ‚îÄ app/
‚îÇ   ‚îú‚îÄ‚îÄ models.py          # +3 models
‚îÇ   ‚îú‚îÄ‚îÄ schemas.py         # +Hook schemas
‚îÇ   ‚îú‚îÄ‚îÄ routers/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ hooks.py       # 8 endpoints
‚îÇ   ‚îî‚îÄ‚îÄ services/
‚îÇ       ‚îú‚îÄ‚îÄ hook_service.py           # Main service + rebuild
‚îÇ       ‚îú‚îÄ‚îÄ hook_file_service.py      # File operations
‚îÇ       ‚îî‚îÄ‚îÄ hook_creation_service.py  # CLI interaction
‚îî‚îÄ‚îÄ migrations/
    ‚îú‚îÄ‚îÄ 003_add_hooks_tables.sql
    ‚îî‚îÄ‚îÄ migrate_add_hooks_tables.py

claudetask/frontend/
‚îî‚îÄ‚îÄ src/
    ‚îú‚îÄ‚îÄ App.tsx            # +Route
    ‚îú‚îÄ‚îÄ components/
    ‚îÇ   ‚îî‚îÄ‚îÄ Sidebar.tsx    # +Menu item
    ‚îî‚îÄ‚îÄ pages/
        ‚îî‚îÄ‚îÄ Hooks.tsx      # Complete UI
```

## üéØ API Endpoints

| Method | Endpoint | –û–ø–∏—Å–∞–Ω–∏–µ |
|--------|----------|----------|
| GET | `/api/projects/{id}/hooks/` | –í—Å–µ —Ö—É–∫–∏ (enabled, default, custom, favorites) |
| POST | `/api/projects/{id}/hooks/enable/{hook_id}` | –í–∫–ª—é—á–∏—Ç—å —Ö—É–∫ |
| POST | `/api/projects/{id}/hooks/disable/{hook_id}` | –û—Ç–∫–ª—é—á–∏—Ç—å —Ö—É–∫ |
| PUT | `/api/projects/{id}/hooks/{hook_id}` | **–û–±–Ω–æ–≤–∏—Ç—å —Ö—É–∫** ‚≠ê |
| POST | `/api/projects/{id}/hooks/create` | –°–æ–∑–¥–∞—Ç—å custom hook |
| DELETE | `/api/projects/{id}/hooks/{hook_id}` | –£–¥–∞–ª–∏—Ç—å custom hook |
| POST | `/api/projects/{id}/hooks/favorites/save` | –í –∏–∑–±—Ä–∞–Ω–Ω–æ–µ |
| POST | `/api/projects/{id}/hooks/favorites/remove` | –ò–∑ –∏–∑–±—Ä–∞–Ω–Ω–æ–≥–æ |

## üé® UI Features

### –í–∫–ª–∞–¥–∫–∏:
1. **Enabled** - –í–∫–ª—é—á–µ–Ω–Ω—ã–µ —Ö—É–∫–∏ (—Å edit/delete –¥–ª—è custom)
2. **Default** - –î–µ—Ñ–æ–ª—Ç–Ω—ã–µ —Ö—É–∫–∏ (—Å edit –∫–Ω–æ–ø–∫–æ–π)
3. **Custom** - –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ —Ö—É–∫–∏ (—Å edit/delete)
4. **Favorites** - –ò–∑–±—Ä–∞–Ω–Ω—ã–µ —Ö—É–∫–∏ (—Å edit/delete)

### Hook Card:
- ‚úÖ –ù–∞–∑–≤–∞–Ω–∏–µ –∏ –æ–ø–∏—Å–∞–Ω–∏–µ
- ‚úÖ –ö–∞—Ç–µ–≥–æ—Ä–∏—è (badge —Å —Ü–≤–µ—Ç–æ–º)
- ‚úÖ Enable/Disable toggle
- ‚úÖ Favorite star icon
- ‚úÖ **Edit button (pencil icon)** ‚≠ê
- ‚úÖ Delete button (—Ç–æ–ª—å–∫–æ custom)
- ‚úÖ Expandable setup instructions
- ‚úÖ Expandable dependencies
- ‚úÖ Expandable JSON config (syntax highlighted)

### Dialogs:
- ‚úÖ Create Custom Hook
- ‚úÖ **Edit Hook** ‚≠ê

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –¢–µ—Å—Ç 1: –í–∫–ª—é—á–∏—Ç—å/–æ—Ç–∫–ª—é—á–∏—Ç—å —Ö—É–∫
```bash
# 1. –í–∫–ª—é—á–∏—Ç—å
POST /api/projects/{id}/hooks/enable/1
# ‚Üí settings.json –ø–æ–ª—É—á–∞–µ—Ç –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é

# 2. –û—Ç–∫–ª—é—á–∏—Ç—å
POST /api/projects/{id}/hooks/disable/1
# ‚Üí –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —É–¥–∞–ª—è–µ—Ç—Å—è –∏–∑ settings.json
```

### –¢–µ—Å—Ç 2: –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –≤–∫–ª—é—á–µ–Ω–Ω—ã–π —Ö—É–∫ ‚≠ê
```bash
# 1. –í–∫–ª—é—á–∏—Ç—å —Ö—É–∫
POST /enable/1

# 2. –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å
PUT /hooks/1
{
  "name": "Updated Hook",
  "hook_config": { "PreToolUse": [...] }
}

# 3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å settings.json
cat .claude/settings.json | jq '.hooks'
# ‚úÖ –ù–æ–≤–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ø—Ä–∏–º–µ–Ω–µ–Ω–∞
# ‚úÖ –°—Ç–∞—Ä–∞—è —É–¥–∞–ª–µ–Ω–∞
# ‚úÖ –î—Ä—É–≥–∏–µ —Ö—É–∫–∏ –Ω–µ –∑–∞—Ç—Ä–æ–Ω—É—Ç—ã
```

### –¢–µ—Å—Ç 3: –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –æ—Ç–∫–ª—é—á–µ–Ω–Ω—ã–π —Ö—É–∫
```bash
# 1. –£–±–µ–¥–∏—Ç—å—Å—è —á—Ç–æ —Ö—É–∫ –æ—Ç–∫–ª—é—á–µ–Ω
# 2. –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å
PUT /hooks/5 {...}
# ‚úÖ –ë–∞–∑–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∞
# ‚úÖ settings.json –ù–ï –∏–∑–º–µ–Ω–µ–Ω (—Ö—É–∫ –æ—Ç–∫–ª—é—á–µ–Ω)

# 3. –í–∫–ª—é—á–∏—Ç—å
POST /enable/5
# ‚úÖ settings.json –ø–æ–ª—É—á–∞–µ—Ç –ù–û–í–£–Æ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é
```

### –¢–µ—Å—Ç 4: –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ —Ö—É–∫–∏
```bash
# –í–∫–ª—é—á–∏—Ç—å 3 —Ö—É–∫–∞
POST /enable/1
POST /enable/2
POST /enable/4

# –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —Ö—É–∫ 2
PUT /hooks/2 {...}

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å settings.json
# ‚úÖ –•—É–∫–∏ 1, 2 (–æ–±–Ω–æ–≤–ª–µ–Ω), 4 –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É—é—Ç
# ‚úÖ –ù–∏–∫–∞–∫–∏—Ö –¥—É–±–ª–∏–∫–∞—Ç–æ–≤
```

## üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞

- **–§–∞–π–ª–æ–≤ —Å–æ–∑–¥–∞–Ω–æ:** ~15
- **–§–∞–π–ª–æ–≤ –∏–∑–º–µ–Ω–µ–Ω–æ:** ~10
- **–°—Ç—Ä–æ–∫ –∫–æ–¥–∞:** ~3000
- **API endpoints:** 8
- **Database tables:** 3
- **Default hooks:** 5
- **Frontend components:** 1 –±–æ–ª—å—à–æ–π
- **Slash commands:** 2
- **Subagents:** 1

## üéâ –°—Ç–∞—Ç—É—Å

### ‚úÖ –ü–û–õ–ù–û–°–¢–¨–Æ –†–ê–ë–û–¢–ê–ï–¢:
- –í–∫–ª—é—á–µ–Ω–∏–µ/–æ—Ç–∫–ª—é—á–µ–Ω–∏–µ —Ö—É–∫–æ–≤
- –°–æ–∑–¥–∞–Ω–∏–µ custom hooks
- **–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ö—É–∫–æ–≤ (default –∏ custom)** ‚≠ê
- **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ settings.json** ‚≠ê
- Favorites
- UI —Å–æ –≤—Å–µ–º–∏ —Ñ—É–Ω–∫—Ü–∏—è–º–∏
- Database persistence
- CLI commands

### üìù –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:
- ‚úÖ `HOOKS_IMPLEMENTATION_SUMMARY.md` - –û–±—â–∞—è —Å–≤–æ–¥–∫–∞
- ‚úÖ `HOOKS_SETTINGS_JSON_USAGE.md` - –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
- ‚úÖ `HOOKS_EDIT_FEATURE_SUMMARY.md` - –§—É–Ω–∫—Ü–∏—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
- ‚úÖ `HOOKS_EDIT_FIX.md` - –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ rename bug
- ‚úÖ `HOOKS_FINAL_FIX.md` - –§–∏–Ω–∞–ª—å–Ω–æ–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ rebuild
- ‚úÖ `HOOKS_COMPLETE_SUMMARY.md` - –≠—Ç–∞ —Å–≤–æ–¥–∫–∞
- ‚úÖ `framework-assets/claude-hooks/README.md` - –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è —Ö—É–∫–æ–≤

---

## üöÄ –ì–æ—Ç–æ–≤–æ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é!

**–í—Å–µ —Ñ—É–Ω–∫—Ü–∏–∏ —Ä–∞–±–æ—Ç–∞—é—Ç:**
- ‚úÖ http://localhost:3000/hooks
- ‚úÖ Backend –Ω–∞ http://localhost:3333
- ‚úÖ –í—Å–µ 5 –¥–µ—Ñ–æ–ª—Ç–Ω—ã—Ö —Ö—É–∫–æ–≤ –¥–æ—Å—Ç—É–ø–Ω—ã
- ‚úÖ –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –ø–æ–ª–Ω–æ—Å—Ç—å—é
- ‚úÖ settings.json –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

**–î–∞—Ç–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è:** 2025-11-13  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ PRODUCTION READY
